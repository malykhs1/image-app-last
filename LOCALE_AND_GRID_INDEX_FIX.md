# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —è–∑—ã–∫–∞ –∏ –∏–Ω–¥–µ–∫—Å–æ–≤ –∫–∞—Ä—Ç–æ—á–µ–∫

## üêõ –ü—Ä–æ–±–ª–µ–º—ã

### 1. **–Ø–∑—ã–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ /en —Å—Ç—Ä–∞–Ω–∏—Ü–µ**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∞ https://paraloom.co.il/en –≤–µ—Å—å —Å–∞–π—Ç –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º, –Ω–æ Anvil –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–≤—Ä–∏—Ç.

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ cross-origin –¥–æ—Å—Ç—É–ø–∞ –∫ `parent.location.href`, –∫–æ–¥ –ø–∞–¥–∞–ª –≤ `except` –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –¥–µ—Ñ–æ–ª—Ç `'he'` (–∏–≤—Ä–∏—Ç).

---

### 2. **"–ö—Ä—É–≥–æ–≤–æ–π" –ø–æ–∫–∞–∑ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —ç—Ç–∞–ø–µ 3**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –º–∞–ª–µ–Ω—å–∫—É—é –∫–∞—Ä—Ç–æ—á–∫—É –≤ grid –Ω–∞ —ç—Ç–∞–ø–µ 3, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏–ª–∞—Å—å –∞–∫—Ç–∏–≤–Ω–æ–π. –ö–∞–∑–∞–ª–æ—Å—å, —á—Ç–æ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è "–ø–æ –∫—Ä—É–≥—É".

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ `on_previous_creation_click()`. –ö–æ–¥ –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª, —á—Ç–æ:
- –ù–∞ —ç—Ç–∞–ø–∞—Ö 1-2: –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ grid (–Ω–∞—á–∏–Ω–∞—è —Å –∏–Ω–¥–µ–∫—Å–∞ 0)
- –ù–∞ —ç—Ç–∞–ø–µ 3: –∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ, grid –∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å –∏–Ω–¥–µ–∫—Å–∞ 1

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ (—É–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞)

**–§–∞–π–ª:** `client_code/Create/__init__.py`, —Å—Ç—Ä–æ–∫–∏ 26-58

**–ù–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º:**
1. **–ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å URL —Ä–æ–¥–∏—Ç–µ–ª—è** (`parent.location.href`)
   - –ï—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç `/en` –∏–ª–∏ `/en/` ‚Üí –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
   - –ò–Ω–∞—á–µ ‚Üí –∏–≤—Ä–∏—Ç (default)

2. **–ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å (cross-origin):**
   - –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å `document.referrer`
   - –ï—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç `/en` –∏–ª–∏ `/en/` ‚Üí –∞–Ω–≥–ª–∏–π—Å–∫–∏–π

3. **–§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä URL `?locale=en`

4. **Default:** –∏–≤—Ä–∏—Ç

**–ö–æ–¥:**
```python
self.locale = 'he'  # Default - –∏–≤—Ä–∏—Ç

try:
  parent_url = anvil.js.window.parent.location.href
  print("CLIENT: Got parent URL: " + str(parent_url))
  if '/en' in parent_url or '/en/' in parent_url:
    self.locale = 'en'
    print("CLIENT: Detected English from parent URL")
  else:
    print("CLIENT: Detected Hebrew from parent URL (default)")
except Exception as e:
  # Cross-origin - –ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ document.referrer
  print("CLIENT: Cannot access parent URL (cross-origin), trying referrer...")
  try:
    referrer = anvil.js.window.document.referrer
    print("CLIENT: Referrer: " + str(referrer))
    if referrer and ('/en' in referrer or '/en/' in referrer):
      self.locale = 'en'
      print("CLIENT: Detected English from referrer")
  except:
    pass
  
  # –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –ø–∞—Ä–∞–º–µ—Ç—Ä URL
  if url_params and url_params.get('locale'):
    self.locale = url_params.get('locale')
    print("CLIENT: Using locale from URL param: " + str(self.locale))
  else:
    print("CLIENT: Using default locale: " + str(self.locale))
```

---

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –∏–Ω–¥–µ–∫—Å–æ–≤ –∫–∞—Ä—Ç–æ—á–µ–∫

**–§–∞–π–ª:** `client_code/Create/__init__.py`, –º–µ—Ç–æ–¥ `on_previous_creation_click`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# ‚ùå –ë–´–õ–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
list_index = grid_index - 1  # –û–¥–Ω–∞ –ª–æ–≥–∏–∫–∞ –¥–ª—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤
```

–ù–∞ —ç—Ç–∞–ø–µ 3:
- `grid_index=1` ‚Üí `list_index=0` ‚Üí `all_creations[0]` (–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞!)
- –ö–ª–∏–∫–∞–ª–∏ –Ω–∞ –ø–µ—Ä–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É –≤ grid, –∞ —Å—Ç–∞–Ω–æ–≤–∏–ª–∞—Å—å –∞–∫—Ç–∏–≤–Ω–æ–π —Ç–µ–∫—É—â–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞
- –°–æ–∑–¥–∞–≤–∞–ª—Å—è —ç—Ñ—Ñ–µ–∫—Ç "–∫—Ä—É–≥–æ–≤–æ–π" –ø—Ä–æ–∫—Ä—É—Ç–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
```python
# ‚úÖ –°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
if self.current_step == 3:
  # –ù–∞ —ç—Ç–∞–ø–µ 3: grid –∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å –∏–Ω–¥–µ–∫—Å–∞ 1
  list_index = grid_index  
else:
  # –ù–∞ —ç—Ç–∞–ø–∞—Ö 1-2: grid –∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å –∏–Ω–¥–µ–∫—Å–∞ 0
  list_index = grid_index - 1
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

**–≠—Ç–∞–ø—ã 1-2:**
```
all_creations = [card1, card2, card3, card4]
                   ‚Üì      ‚Üì      ‚Üì      ‚Üì
grid (visible) = [card1, card2, card3, card4]
                   idx=1  idx=2  idx=3  idx=4

grid_index=1 ‚Üí list_index=0 ‚Üí all_creations[0] ‚úì
```

**–≠—Ç–∞–ø 3:**
```
all_creations = [ACTIVE, card2, card3, card4, card5]
                    ‚Üì      ‚Üì      ‚Üì      ‚Üì      ‚Üì
center (active) = ACTIVE
grid (visible)  =       [card2, card3, card4, card5]
                         idx=1  idx=2  idx=3  idx=4

grid_index=1 ‚Üí list_index=1 ‚Üí all_creations[1] ‚úì
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ –Ω–∞ /en —Å—Ç—Ä–∞–Ω–∏—Ü–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://paraloom.co.il/en
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ iframe –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12)
4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   ```
   CLIENT: Got parent URL: https://paraloom.co.il/en/...
   CLIENT: Detected English from parent URL
   ```
5. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ **–∞–Ω–≥–ª–∏–π—Å–∫–æ–º**

---

### –¢–µ—Å—Ç 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://paraloom.co.il/
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ iframe –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   ```
   CLIENT: Got parent URL: https://paraloom.co.il/...
   CLIENT: Detected Hebrew from parent URL (default)
   ```
4. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ **–∏–≤—Ä–∏—Ç–µ**

---

### –¢–µ—Å—Ç 3: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ —ç—Ç–∞–ø–µ 3

1. –°–æ–∑–¥–∞–π—Ç–µ 4 artwork
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —ç—Ç–∞–ø 3
3. –í —Ü–µ–Ω—Ç—Ä–µ –ø–æ–∫–∞–∑–∞–Ω–∞ –ø–µ—Ä–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ö–æ—Ç")
4. –í grid –ø–æ–¥ –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π: "–°–æ–±–∞–∫–∞", "–†–µ–±–µ–Ω–æ–∫", "–ü–µ–π–∑–∞–∂"
5. **–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ "–°–æ–±–∞–∫–∞"** –≤ grid
6. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ "–°–æ–±–∞–∫–∞" –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –≤ —Ü–µ–Ω—Ç—Ä (—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ–π)
   - ‚úÖ "–ö–æ—Ç" –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –≤ grid
   - ‚úÖ –û—Å—Ç–∞–µ—Ç–µ—Å—å –Ω–∞ —ç—Ç–∞–ø–µ 3
   - ‚úÖ –ë–æ–ª—å—à–µ –ù–ï–¢ "–∫—Ä—É–≥–æ–≤–æ–≥–æ" —ç—Ñ—Ñ–µ–∫—Ç–∞

---

### –¢–µ—Å—Ç 4: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω–∞ —ç—Ç–∞–ø–∞—Ö 1-2

1. –°–æ–∑–¥–∞–π—Ç–µ 3 artwork
2. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ —ç—Ç–∞–ø 1 –∏–ª–∏ 2
3. –í grid –ø–æ–¥ –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π –≤–∏–¥–Ω—ã –≤—Å–µ 3 –∫–∞—Ä—Ç–æ—á–∫–∏
4. **–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ª—é–±—É—é –∫–∞—Ä—Ç–æ—á–∫—É**
5. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - ‚úÖ –ö–∞—Ä—Ç–æ—á–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ–π
   - ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —ç—Ç–∞–ø 3
   - ‚úÖ –ö–ª–∏–∫–Ω—É—Ç–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Ü–µ–Ω—Ç—Ä–µ

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚ùå –ù–∞ /en —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª—Å—è –∏–≤—Ä–∏—Ç
- ‚ùå –ù–∞ —ç—Ç–∞–ø–µ 3 –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏–ª–∞—Å—å –∞–∫—Ç–∏–≤–Ω–æ–π
- ‚ùå –≠—Ñ—Ñ–µ–∫—Ç "–∫—Ä—É–≥–æ–≤–æ–π" –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –∫–∞—Ä—Ç–æ—á–µ–∫

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚úÖ –Ø–∑—ã–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ URL (—Å fallback –Ω–∞ referrer –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä)
- ‚úÖ –ù–∞ —ç—Ç–∞–ø–µ 3 –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ–π –ø—Ä–∏ –∫–ª–∏–∫–µ
- ‚úÖ –õ–æ–≥–∏–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö
- ‚úÖ –ù–µ—Ç "–∫—Ä—É–≥–æ–≤–æ–≥–æ" —ç—Ñ—Ñ–µ–∫—Ç–∞

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–û–±–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:
1. **–Ø–∑—ã–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø–æ URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã (—Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–æ–π fallback)
2. **–ö–ª–∏–∫ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ** –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö, –≤–∫–ª—é—á–∞—è —ç—Ç–∞–ø 3

